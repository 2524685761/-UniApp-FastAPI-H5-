---
description: 调试手册（端口/BaseURL/启动失败/缓存/VPN）
globs:
  - "**/*"
---

## 1) 前端请求端口不对（8001/8000 混乱）
现象：前端一直打到 `http://127.0.0.1:8001`，但后端在 `8000`。
原因：前端缓存了 baseURL：`uni.getStorageSync('api_base_url')`。

处理：
- 方式 A：前端清理缓存 key `api_base_url`（H5 可尝试 localStorage）
- 方式 B：在设置页做“重置后端地址”按钮，调用 `setBaseURL(DEFAULT_BASE_URL)`

## 2) 后端启动失败（Windows 常见）
建议排查顺序：
- `python -c "import backend.main"`（最快定位 import 阶段异常）
- 避免 `--reload`（Windows 子进程会让报错不直观）
- 端口占用：检查 8000 是否被占用

## 3) TTS 听起来“没变”
优先怀疑缓存命中：
- 清空 `uploads/tts/` 再试
- 或用不同文本测试

## 4) 为什么要 VPN / 为什么启动很慢
典型原因：
- 情感识别模型访问 HuggingFace（国内易超时/需要代理）
- FunASR/ModelScope 首次下载模型很大

建议：
- 默认不要求 VPN：关闭情感 HF 模型或启用离线缓存
- FunASR 关闭 update check：`disable_update=True`

